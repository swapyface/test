import pandas as pd

def update_df1_from_df2(df1, df2, id_column='id', price_column='price', 
                          maturity_date_column='maturity_date', bid_column='bid', 
                          ask_column='ask'):
    """
    Updates df1 with price, maturity date, bid, and ask from df2 based on a common ID.

    Args:
        df1 (pd.DataFrame): The DataFrame to be updated.
        df2 (pd.DataFrame): The DataFrame containing the update information.
        id_column (str): The name of the ID column.
        price_column (str): The name of the price column.
        maturity_date_column (str): The name of the maturity date column.
        bid_column (str): The name of the bid column.
        ask_column (str): The name of the ask column.

    Returns:
        pd.DataFrame: The updated df1.
    """

    # Create a dictionary for efficient lookup in df2
    df2_map = df2.set_index(id_column)[[price_column, maturity_date_column, bid_column, ask_column]].to_dict('index')

    def update_row(row):
        id_val = row[id_column]
        if id_val in df2_map:
            update_data = df2_map[id_val]
            if price_column in update_data:
                row[price_column] = update_data[price_column]
            if maturity_date_column in update_data:
                row[maturity_date_column] = update_data[maturity_date_column]
            if bid_column in update_data:
                row[bid_column] = update_data[bid_column]
            if ask_column in update_data:
                row[ask_column] = update_data[ask_column]
        return row

    return df1.apply(update_row, axis=1)

# Example usage:
# Create sample DataFrames
data1 = {'id': [1, 2, 1, 3, 2], 'other_col': ['a', 'b', 'c', 'd', 'e'], 'price': [10, 20, 30, 40, 50], 'maturity_date':['2023-01-01','2023-02-01','2023-03-01','2023-04-01','2023-05-01'], 'bid':[1,2,3,4,5], 'ask':[6,7,8,9,10]}
data2 = {'id': [1, 2, 4], 'price': [100, 200, 400], 'maturity_date':['2024-01-01','2024-02-01','2024-04-01'], 'bid':[11,12,13], 'ask':[16,17,18]}

df1 = pd.DataFrame(data1)
df2 = pd.DataFrame(data2)

# Update df1
updated_df1 = update_df1_from_df2(df1, df2)

print(updated_df1)
