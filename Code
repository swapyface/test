import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
import numpy as np

# Example dataset (replace with your actual data)
data = pd.DataFrame({
    'price': np.random.lognormal(mean=2, sigma=0.8, size=100000)  # Skewed data
})

# Calculate Z-scores
mean = data['price'].mean()
std_dev = data['price'].std()
data['z_score'] = (data['price'] - mean) / std_dev

# Define colors for Z-scores
z_colors = {1: 'green', 2: 'orange', 3: 'purple', -1: 'blue', -2: 'cyan', -3: 'magenta'}

# Plot histogram
plt.figure(figsize=(10, 6))
sns.histplot(data['price'], bins=50, kde=True, color='blue', alpha=0.6)

# Add vertical lines for Z-scores (±1, ±2, ±3)
for z, color in z_colors.items():
    z_value = mean + z * std_dev  # Convert Z-score back to raw value
    label = f"Z={z}"
    plt.axvline(z_value, color=color, linestyle='--', linewidth=1.5, label=label)

# Add mean as a special red line
plt.axvline(mean, color='red', linestyle='-', linewidth=1.5, label="Mean (Z=0)")

# Labels and legend
plt.title('Histogram with Z-scores and Different Colors')
plt.xlabel('Price')
plt.ylabel('Frequency')
plt.legend()
plt.show()