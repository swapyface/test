import pandas as pd

# Assuming you have loaded your dataset into a DataFrame called df
# df = pd.read_csv("your_dataset.csv")

# Define the target number of records per category
target_records = 20000

# Initialize an empty DataFrame to store the sampled records
sampled_df = pd.DataFrame()

# Iterate through each category in the 'rating' column
for category in df['rating'].unique():
    # Get all records of the current category
    category_df = df[df['rating'] == category]
    
    # If the category has fewer records than the target, take all the records; otherwise, sample 20,000
    if len(category_df) >= target_records:
        sampled_category = category_df.sample(n=target_records, random_state=42)
    else:
        sampled_category = category_df
    
    # Append the sampled records to the final DataFrame
    sampled_df = pd.concat([sampled_df, sampled_category])

# Save the sampled data to a CSV file
sampled_df.to_csv('test.csv', index=False)

print(f"Sampled data saved to test.csv with {len(sampled_df)} records.")
